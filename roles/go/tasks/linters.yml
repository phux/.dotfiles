---

- name: check to see if golangci-lint is already installed
  command: "golangci-lint --help"
  ignore_errors: true
  register: golangci_lint_installed
  changed_when: false

- name: installing golangci-lint
  shell: >
    source ~/.config/zsh/.zshrc &&
    go get -u github.com/golangci/golangci-lint/cmd/golangci-lint
    executable=/bin/zsh

- block:

  - name: Link .golangci-lint config
    file:
      src: "{{item}}"
      dest: "{{ ansible_env.HOME }}/{{ item | basename }}"
      state: link
    with_fileglob:
      - .golangci-lint.json

  when: golangci_lint_installed.rc != 0

- name: installing golangci-lint
  shell: >
    source ~/.config/zsh/.zshrc &&
    go get -u github.com/mgechev/revive
    executable=/bin/zsh
